<h3 mat-dialog-title>{{'Edit document' | translate}}</h3>
<div mat-dialog-content class="d-flex flex-column">
  <mat-card class="mb-3">
    <mat-card-content *ngIf="folders !== undefined">
      <div class="d-flex flex-column">
        <mat-slide-toggle
          id="documentStatusToggle"
          [(ngModel)]="newDocumentModel.status"
        >
          {{ 'Enabled' | translate }}
        </mat-slide-toggle>
        <mat-form-field>
          <mat-label>{{'Selected folder' | translate}}</mat-label>
          <mtx-select
            class="custom"
            dropdownPosition="bottom"
            [clearable]="false"
            [bindLabel]="'name'"
            [bindValue]="'id'"
            [(ngModel)]="selectedFolder"
            id="editDocumentFolderSelector"
            [items]="folders"
          >
          </mtx-select>
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3">
    <mat-card-title>{{ 'Assign to property' | translate }}</mat-card-title>
    <mat-card-content *ngIf="availableProperties !== undefined">
      <div class="d-grid grid-2-columns">
        <ng-container *ngFor="let property of availableProperties; let propertyIndex = index; last as isLast">
          <mat-checkbox
            (ngModelChange)="addToArray($event, getAssignmentByPropertyId(property.id).propertyId)"
            [ngModel]="getAssignmentIsCheckedByPropertyId(property.id)"
            [class.mb-2]="availableProperties.length > 2 && !isLast && propertyIndex != availableProperties.length - 2"
          >
            {{ property.name }}
          </mat-checkbox>
        </ng-container>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3" *ngFor="let translation of languages; let translationIndex = index">
    <mat-card-title>{{ getLanguageByLanguageId(translation.id).text }}</mat-card-title>
    <mat-card-content class="d-flex flex-column need-wrapper">
      <mat-form-field>
        <mat-label>{{'Name DOCX' | translate}}</mat-label>
        <input
          matInput
          type="text"
          id="createDocumentNameDocxTranslation_{{ translationIndex }}"
          name="createDocumentNameDocxTranslation_{{translationIndex}}"
          [(ngModel)]="getTranslateByLanguageId(translation.id, 'docx').name"
        />
      </mat-form-field>
      <formatting-text-editor
        [(value)]="getTranslateByLanguageId(translation.id, 'docx').description"
        [placeholder]="'Description DOCX' | translate"
        id="createDocumentDescriptionDocxTranslation_{{translationIndex}}"
      >
      </formatting-text-editor>
      <div class="mt-3">
        <input
          type="file"
          hidden
          [accept]="'application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
          (change)="onFileSelected($event, translation.id, 'docx')"
          id="docInput{{ translationIndex }}"
          #fileDocUpload
        />
        <div>{{getFileNameByLanguage(translation.id, 'docx') || 'No file uploaded yet.' | translate}}
          <button
            mat-raised-button
            color="accent"
            (click)="fileDocUpload.click()"
          >
            {{ 'Select DOCX' | translate }}
          </button>
          <ng-container *ngIf="getFileNameByLanguage(translation.id, 'docx')">
            <button
              mat-icon-button
              color="warn"
              (click)="removeFile(translation.id, 'docx')"
              [matTooltip]="'Remove file' | translate"
            >
              <mat-icon>delete</mat-icon>
            </button>
            <button
              mat-icon-button
              color="accent"
              (click)="getFile(translation.id, 'docx')"
              matTooltip="{{ 'Show DOC' | translate }}"
            >
              <mat-icon svgIcon="file-word"></mat-icon>
            </button>
          </ng-container>
        </div>
      </div>
    </mat-card-content>
    <mat-card-content class="d-flex flex-column need-wrapper mt-3">
      <mat-form-field>
        <mat-label>{{'Name PDF' | translate}}</mat-label>
        <input
          matInput
          type="text"
          id="createDocumentNamePdfTranslation_{{ translationIndex }}"
          name="createDocumentNamePdfTranslation_{{translationIndex}}"
          [(ngModel)]="getTranslateByLanguageId(translation.id, 'pdf').name"
        />
      </mat-form-field>
      <formatting-text-editor
        [(value)]="getTranslateByLanguageId(translation.id, 'pdf').description"
        [placeholder]="'Description PDF' | translate"
        id="createDocumentDescriptionPdfTranslation_{{translationIndex}}"
      >
      </formatting-text-editor>
      <div class="mt-3">
        <input
          type="file"
          hidden
          [accept]="'application/pdf'"
          (change)="onFileSelected($event, translation.id, 'pdf')"
          id="pdfInput{{ translationIndex }}"
          #filePdfUpload
        />
        <div>{{getFileNameByLanguage(translation.id, 'pdf') || 'No file uploaded yet.' | translate}}
          <button
            mat-raised-button
            color="accent"
            (click)="filePdfUpload.click()"
          >
            {{ 'Select PDF' | translate }}
          </button>
          <ng-container *ngIf="getFileNameByLanguage(translation.id)">
            <button
              mat-icon-button
              color="warn"
              (click)="removeFile(translation.id, 'pdf')"
              [matTooltip]="'Remove file' | translate"
            >
              <mat-icon>delete</mat-icon>
            </button>
            <button
              mat-icon-button
              color="accent"
              (click)="getFile(translation.id, 'pdf')"
              matTooltip="{{ 'Show PDF' | translate }}"
            >
              <mat-icon svgIcon="file-pdf"></mat-icon>
            </button>
          </ng-container>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3">
    <mat-card-content>
      <mat-form-field  [owlDateTimeTrigger]="dt1">
        <mat-label>{{'End date' | translate}}</mat-label>
        <input
          matInput
          [owlDateTime]="dt1"
          [ngModel]="newDocumentModel.endDate"
          (ngModelChange)="updateStartDate($event)"
          type="text"
          id="createStartFrom"
          name="createStartFrom"
        />
        <owl-date-time [pickerType]="'calendar'" #dt1></owl-date-time>
      </mat-form-field>
    </mat-card-content>
  </mat-card>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <button
    mat-raised-button
    color="accent"
    id="documentEditSaveBtn"
    (click)="updateDocument()"
    [disabled]="disabledSaveBtn"
  >
    {{ 'Update' | translate }}
  </button>
  <button
    mat-raised-button
    id="documentEditCancelBtn"
    (click)="hide()"
  >
    {{ 'Cancel' | translate }}
  </button>
</div>
