<h3 mat-dialog-title>{{(isCreate ? 'Create new task' : 'View task') | translate}}</h3>
<div mat-dialog-content class="d-flex flex-column" [formGroup]="workOrderCaseForm">
  <div class="d-flex flex-row need-wrapper">
    <mat-form-field>
      <mat-label>{{'Property' | translate }}</mat-label>
      <mtx-select
        appendTo="body"
        [items]="properties"
        bindLabel="name"
        bindValue="id"
        formControlName="propertyId"
        id="propertyId"
        [clearable]="false">
      </mtx-select>
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{'Area' | translate }}</mat-label>
      <mtx-select
        appendTo="body"
        [items]="propertyAreas"
        formControlName="areaName"
        id="areaName"
        [clearable]="false">
      </mtx-select>
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{'Assigned to' | translate }}</mat-label>
      <mtx-select
        appendTo="body"
        bindLabel="name"
        bindValue="id"
        formControlName="assignedTo"
        id="assignedTo"
        [items]="assignedSitesToProperty"
        [clearable]="isCreate">
      </mtx-select>
    </mat-form-field>
  </div>
  <div>
    <button
      mat-icon-button
      color="primary"
      *ngIf="isCreate"
      matTooltip="{{'Add new image' | translate}}"
      (click)="openAddImage()"
      id="addNewImages"
    >
      <mat-icon>add</mat-icon>
    </button>
  </div>
  <div class="d-flex flex-row flex-wrap justify-content-between">
    <mat-card
      *ngFor="let image of images; let i = index"
      style="width: 200px;"
      class="d-flex flex-column justify-content-between m-1"
    >
      <mat-card-content>
        <img
          mat-card-image
          (click)="openPicture(i)"
          [src]="image.src | authImage | async"
          alt="Card image cap"
        >
      </mat-card-content>
      <mat-card-footer>
        <div class="d-flex justify-content-center">
          <button
            mat-icon-button
            color="warn"
            matTooltip="{{'Delete picture' | translate}}"
            *ngIf="isCreate"
            (click)="deleteImageByName(image.fileName)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </mat-card-footer>
    </mat-card>
  </div>
  <mat-form-field>
    <mat-label>{{'Description of task' | translate}}</mat-label>
    <textarea
      matInput
      type="text"
      id="descriptionTask"
      formControlName="descriptionTask"
      [readonly]="!isCreate"
      rows="5"
      cols="46"
    ></textarea>
  </mat-form-field>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <button
    mat-raised-button
    color="accent"
    id="taskManagementCreateShowSaveBtn"
    [disabled]="!(workOrderCaseForm.valid && isCreate)"
    (click)="create()"
  >
    {{(!isCreate ? 'Save' : 'Create') | translate}}
  </button>
  <button
    mat-raised-button
    (click)="hide()"
    id="taskManagementCreateShowSaveCancelBtn"
  >
    {{'Cancel' | translate}}
  </button>
</div>
