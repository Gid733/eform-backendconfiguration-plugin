<div
  [config]="{ ignoreBackdropClick: true }"
  mdbModal
  class="modal fade"
  #frame="mdbModal"
>
  <div class="modal-dialog {{selectedArea.type === 10 ? 'modal-fluid' : 'modal-md' }}">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{{ 'Edit rule' | translate }}</h3>
        <button class="close" data-dismiss="modal" (click)="frame.hide()">
          <span>Ã—</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <!-- Show all translations for rule -->
          <ng-container
            *ngFor="
              let translation of selectedAreaRule.translatedNames;
              let k = index
            "
          >
            <div class="row">
              <div class="col-md-12">
                <div class="md-form">
                  <input
                    mdbInput
                    type="text"
                    [(ngModel)]="translation.name"
                    class="form-control"
                    id="editRuleName{{ k }}"
                    [disabled]="planningStatus && selectedArea.type === 10 || selectedAreaRule.secondaryeFormName === 'Morgenrundtur'"
                  />
                  <label for="editRuleName{{ k }}">{{
                    translation.description | translate
                  }}</label>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="selectedAreaRule.typeSpecificFields">
            <!-- Rule type 1, 5, 3 -->
            <ng-container
              *ngIf="
                selectedArea.type === 1 ||
                selectedArea.type === 5 ||
                selectedArea.type === 3 ||
                selectedAreaRule.secondaryeFormName === 'Morgenrundtur'
              "
            >
              <div class="row">
                <div class="col-12 ng-select-wrapper">
                  <ng-select
                    [items]="
                      templatesModel.templates &&
                      templatesModel.templates.length > 0
                        ? templatesModel.templates
                        : [
                            {
                              id: selectedAreaRule.eformId,
                              label: selectedAreaRule.eformName
                            }
                          ]
                    "
                    bindLabel="label"
                    [placeholder]="'Selected template' | translate"
                    bindValue="id"
                    [typeahead]="typeahead"
                    [ngModel]="selectedAreaRule.eformId"
                    (ngModelChange)="changeEform($event)"
                    id="editRuleEformId"
                    [clearable]="true"
                  >
                  </ng-select>
                </div>
              </div>
            </ng-container>
            <!-- Rule type 2 -->
            <ng-container *ngIf="selectedArea.type === 2">
              <div class="row">
                <div class="col-12 ng-select-wrapper">
                  <ng-select
                    [items]="[
                      { id: 1, name: 'Open' | translate },
                      { id: 2, name: 'Closed' | translate }
                    ]"
                    bindLabel="name"
                    [placeholder]="'Type' | translate"
                    bindValue="id"
                    [(ngModel)]="selectedAreaRule.typeSpecificFields.type"
                    id="editRuleType"
                    [clearable]="false"
                  >
                  </ng-select>
                </div>
              </div>
              <div class="row">
                <div class="col-12 ng-select-wrapper">
                  <ng-select
                    [items]="[
                      { id: 1, name: 'Yes' | translate },
                      { id: 2, name: 'No' | translate }
                    ]"
                    bindLabel="name"
                    [placeholder]="'Alarm' | translate"
                    bindValue="id"
                    [(ngModel)]="selectedAreaRule.typeSpecificFields.alarm"
                    id="editRuleAlarm"
                    [clearable]="false"
                  >
                  </ng-select>
                </div>
              </div>
            </ng-container>
            <!-- Rule type 5 -->
            <ng-container *ngIf="selectedArea.type === 5">
              <div class="row">
                <div class="col-12 ng-select-wrapper">
                  <ng-select
                    [items]="[
                      { id: 1, name: 'Monday' | translate },
                      { id: 2, name: 'Tuesday' | translate },
                      { id: 3, name: 'Wednesday' | translate },
                      { id: 4, name: 'Thursday' | translate },
                      { id: 5, name: 'Friday' | translate },
                      { id: 6, name: 'Saturday' | translate },
                      { id: 0, name: 'Sunday' | translate }
                    ]"
                    bindLabel="name"
                    [placeholder]="'Day of week' | translate"
                    bindValue="id"
                    [(ngModel)]="selectedAreaRule.typeSpecificFields.dayOfWeek"
                    id="editAreaRuleDayOfWeek"
                    [clearable]="false"
                  >
                  </ng-select>
                </div>
                <div class="col-12 ng-select-wrapper">
                  <ng-select
                    [items]="[
                      { id: 1, name: 'Weekly' | translate },
                      { id: 2, name: '2nd week' | translate },
                      { id: 3, name: '3rd week' | translate },
                      { id: 4, name: '4th week' | translate },
                      { id: 5, name: '5th week' | translate },
                      { id: 6, name: '6th week' | translate },
                      { id: 7, name: '7th week' | translate },
                      { id: 8, name: '8th week' | translate },
                      { id: 9, name: '9th week' | translate },
                      { id: 10, name: '10th week' | translate },
                      { id: 11, name: '11st week' | translate },
                      { id: 12, name: '12nd week' | translate },
                      { id: 13, name: '13rd week' | translate },
                      { id: 14, name: '14th week' | translate },
                      { id: 15, name: '15th week' | translate },
                      { id: 16, name: '16th week' | translate },
                      { id: 17, name: '17th week' | translate },
                      { id: 18, name: '18th week' | translate },
                      { id: 19, name: '19th week' | translate },
                      { id: 20, name: '20th week' | translate },
                      { id: 21, name: '21st week' | translate },
                      { id: 22, name: '22nd week' | translate },
                      { id: 23, name: '23rd week' | translate },
                      { id: 24, name: '24th week' | translate },
                      { id: 25, name: '25th week' | translate },
                      { id: 26, name: '26th week' | translate },
                      { id: 27, name: '27th week' | translate },
                      { id: 28, name: '28th week' | translate },
                      { id: 29, name: '29th week' | translate },
                      { id: 30, name: '30th week' | translate },
                      { id: 31, name: '31st week' | translate },
                      { id: 32, name: '32nd week' | translate },
                      { id: 33, name: '33rd week' | translate },
                      { id: 34, name: '34th week' | translate },
                      { id: 35, name: '35th week' | translate },
                      { id: 36, name: '36th week' | translate },
                      { id: 37, name: '37th week' | translate },
                      { id: 38, name: '38th week' | translate },
                      { id: 39, name: '39th week' | translate },
                      { id: 40, name: '40th week' | translate },
                      { id: 41, name: '41st week' | translate },
                      { id: 42, name: '42nd week' | translate },
                      { id: 43, name: '43rd week' | translate },
                      { id: 44, name: '44th week' | translate },
                      { id: 45, name: '45th week' | translate },
                      { id: 46, name: '46th week' | translate },
                      { id: 47, name: '47th week' | translate },
                      { id: 48, name: '48th week' | translate },
                      { id: 49, name: '49th week' | translate },
                      { id: 50, name: '50th week' | translate },
                      { id: 51, name: '51st week' | translate },
                      { id: 52, name: '52nd week' | translate },
                    ]"
                    bindLabel="name"
                    [placeholder]="'Repeat every' | translate"
                    bindValue="id"
                    [(ngModel)]="
                      selectedAreaRule.typeSpecificFields.repeatEvery
                    "
                    id="editRepeatEvery"
                    [clearable]="false"
                  >
                  </ng-select>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="selectedArea.type === 10 &&  selectedAreaRule.secondaryeFormName !== 'Morgenrundtur'">
              <table
                mdbTable
                striped="true"
                hover="true"
                small="true"
                class="z-depth-1 text-center">
                <thead>
                <tr>
                  <th>
                            <span>
                              {{ 'Weekdays' | translate }}
                            </span>
                  </th>
                  <ng-container *ngFor="let hour of hours let j = index">
                    <th>
                            <span>
                              kl {{ hour }}:00
                            </span>
                    </th>
                  </ng-container>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let day of days; let i = index">
                  <td>
                            <span>
                              {{ day | translate }}
                            </span>
                  </td>
                  <ng-container *ngFor="let hour of hours let j = index">
                    <td>
                      <input
                        type="checkbox"
                        (click)="checked($event, i, j, selectedAreaRule)"
                        [checked]="isChecked(i, j, selectedAreaRule)"
                        [disabled]="planningStatus"
                      />
                    </td>
                  </ng-container>
                </tbody>
              </table>
            </ng-container>
          </ng-container>
        </div>
      </div>
      <div class="modal-footer">
        <button *ngIf="!planningStatus"
          mdbBtn
          class="btn-success btn-small-height"
          (click)="onUpdateAreaRule()"
          id="areaRuleEditSaveBtn"
        >
          {{ 'Save' | translate }}
        </button>
        <button *ngIf="!planningStatus"
          mdbBtn
          class="btn-accent text-black-50 btn-small-height"
          (click)="frame.hide()"
          id="areaRuleEditSaveCancelBtn"
        >
          {{ 'Cancel' | translate }}
        </button>
        <button *ngIf="planningStatus"
          mdbBtn
          class="btn-accent text-black-50 btn-small-height"
          (click)="frame.hide()"
          id="areaRuleEditCloseBtn"
        >
          {{ 'Close' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
