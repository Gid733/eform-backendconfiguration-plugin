<ng-template #toolbarTpl>
  <div class="d-flex flex-row justify-content-start flex-nowrap">
    <div class="d-flex flex-column mr-2 ml-2">
      <mat-form-field>
        <mat-label>{{ 'Search' | translate }}</mat-label>
        <input
          matInput
          type="text"
          (ngModelChange)="onNameFilterChanged($event)"
          [ngModel]="propertiesStateService.getNameFilter() | async"
          id="nameInput"
        />
      </mat-form-field>
    </div>
  </div>
</ng-template>

<mtx-grid
  [data]="propertiesModel.entities"
  [columns]="tableHeaders"
  [cellTemplate]="{actions: actionsTpl, compliance: complianceTpl}"
  [showPaginator]="false"
  [pageOnFront]="false"
  [rowStriped]="true"
  [showToolbar]="true"
  [showColumnMenuButton]="false"
  [toolbarTemplate]="toolbarTpl"
  [sortActive]="propertiesStateService.getActiveSort() | async"
  [sortDirection]="propertiesStateService.getActiveSortDirection() | async"
  (sortChange)="sortTable($event)">
</mtx-grid>

<ng-template #complianceTpl let-row>
  <button
    mat-icon-button
    [color]="getColorBadge(row.complianceStatus)"
    id="showCompliancesBtn"
    matTooltip="{{ 'View compliance' | translate }}"
    [routerLink]="['../compliances/', row.id]"
    [disabled]="!row.isWorkersAssigned"
  >
    <mat-icon>list_alt</mat-icon>
  </button>
</ng-template>

<ng-template #actionsTpl let-row>
  <button
    mat-icon-button
    color="accent"
    id="showPropertyAreasBtn"
    matTooltip="{{ 'View areas' | translate }}"
    [routerLink]="'../property-areas/' + row.id"
    [disabled]="!row.isWorkersAssigned"
  >
    <mat-icon>home_repair_service</mat-icon>
  </button>
  <button
    color="accent"
    *ngIf="authStateService.isAdmin"
    mat-icon-button
    id="docxReportBtn"
    matTooltip="{{ 'Select report' | translate }}"
    (click)="onShowDocxReportModal(row.id)"
  >
    <mat-icon [svgIcon]="'file-word'"></mat-icon>
  </button>
  <button
    *ngIf="row.workorderEnable"
    mat-icon-button
    color="accent"
    id="updateEntityList"
    (click)="onShowEditEntityListModal(row)"
    matTooltip="{{ 'Edit list of areas for workorder' | translate }}"
  >
    <mat-icon>list</mat-icon>
  </button>
  <button
    mat-icon-button
    id="editPropertyBtn"
    matTooltip="{{ 'Edit property' | translate }}"
    (click)="onShowEditPropertyModal(row)"
  >
    <mat-icon>edit</mat-icon>
  </button>
  <button
    mat-icon-button
    color="warn"
    id="deletePropertyBtn"
    matTooltip="{{ 'Delete property' | translate }}"
    (click)="onShowDeletePropertyModal(row)"
  >
    <mat-icon>delete</mat-icon>
  </button>
</ng-template>
